import"./DsnmJJEf.js";import{C as Rt,D as Oe,B as Se,bh as Te,L as je,H as Ae,V as Pe,a7 as pe,E as Ce,a6 as He,Q as Le,O as Fe,K as Re,g as oe,e as ze,u as Ue,bi as Ye,bj as Be,p as G,f as O,d as f,r as _,s as M,b,c as K,am as J,a as N,ak as at,ao as r,aV as Bt,au as ie,ap as w,t as B,b6 as le,be as Nt,bk as Ne,al as zt,at as Xe,h as Ht,bl as qe,a2 as ce,bf as Ve,bg as Je}from"./D2qwY2pA.js";import{s as tt}from"./Ciw69Xbt.js";import{s as z}from"./BD1Gwmmh.js";import{i as S}from"./DSpFVM1A.js";import{a as et,C as de,S as ht,s as Y,c as ue,r as _e,b as Ut}from"./IBLeJA0B.js";import{p as T}from"./n-eLVRDd.js";import{s as Ge,e as ve,b as Ke}from"./CXSYTu6O.js";import{t as W,s as $}from"./CG-PKhat.js";import{b as Qe,a as Ze}from"./CweSHcT0.js";import{b as We}from"./DP7rYyvM.js";import{h as Lt}from"./DJ3wkFct.js";import{a as lt,n as Xt,g as Qt,b as $e,e as ta,m as Zt,c as Et,f as Ft,F as ea}from"./mglCFlAv.js";import{s as It,o as aa,a as Wt,m as na}from"./C-_V8m2x.js";import{c as sa,b as ra}from"./C06iX-dI.js";function oa(e,t,a){Rt&&Oe();var s=e,n=He,o,l,c=null,i=Te;function m(){o&&Le(o),c!==null&&(c.lastChild.remove(),s.before(c),c=null),o=l}Se(()=>{if(i(n,n=t())){var v=s,y=pe();y&&(c=document.createDocumentFragment(),c.append(v=je())),l=Ae(()=>a(v)),y?Pe.add_callback(m):m()}}),Rt&&(s=Ce)}function ia(e,t){Rt&&Fe(Re(e)),oe(()=>{var a=t();for(var s in a){var n=a[s];n?e.style.setProperty(s,n):e.style.removeProperty(s)}})}function la(e,t,a){ze(()=>{var s=Ue(()=>t(e,a?.())||{});if(a&&s?.update){var n=!1,o={};oe(()=>{var l=a();Ye(l),n&&Be(o,l)&&(o=l,s.update(l))}),n=!0}if(s?.destroy)return()=>s.destroy()})}const ca=sa();function Ot(e,t){const a=+lt(e)-+lt(t);return a<0?-1:a>0?1:a}function da(e,t,a){const[s,n]=Xt(a?.in,e,t),o=s.getFullYear()-n.getFullYear(),l=s.getMonth()-n.getMonth();return o*12+l}function ua(e){return t=>{const a=Math.trunc,s=a(t);return s===0?0:s}}function _a(e,t){return+lt(e)-+lt(t)}function va(e,t){const a=lt(e,t?.in);return a.setHours(23,59,59,999),a}function fa(e,t){const a=lt(e,t?.in),s=a.getMonth();return a.setFullYear(a.getFullYear(),s+1,0),a.setHours(23,59,59,999),a}function ma(e,t){const a=lt(e,t?.in);return+va(a,t)==+fa(a,t)}function ha(e,t,a){const[s,n,o]=Xt(a?.in,e,e,t),l=Ot(n,o),c=Math.abs(da(n,o));if(c<1)return 0;n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-l*c);let i=Ot(n,o)===-l;ma(s)&&c===1&&Ot(s,o)===1&&(i=!1);const m=l*(c-+i);return m===0?0:m}function ga(e,t,a){const s=_a(e,t)/1e3;return ua()(s)}function $t(e,t,a){const s=$e(),n=a?.locale??s.locale??ta,o=2520,l=Ot(e,t);if(isNaN(l))throw new RangeError("Invalid time value");const c=Object.assign({},a,{addSuffix:a?.addSuffix,comparison:l}),[i,m]=Xt(a?.in,...l>0?[t,e]:[e,t]),v=ga(m,i),y=(Qt(m)-Qt(i))/1e3,h=Math.round((v-y)/60);let u;if(h<2)return h===0?n.formatDistance("lessThanXMinutes",1,c):n.formatDistance("xMinutes",h,c);if(h<45)return n.formatDistance("xMinutes",h,c);if(h<90)return n.formatDistance("aboutXHours",1,c);if(h<Zt){const g=Math.round(h/60);return n.formatDistance("aboutXHours",g,c)}else{if(h<o)return n.formatDistance("xDays",1,c);if(h<Et){const g=Math.round(h/Zt);return n.formatDistance("xDays",g,c)}else if(h<Et*2)return u=Math.round(h/Et),n.formatDistance("aboutXMonths",u,c)}if(u=ha(m,i),u<12){const g=Math.round(h/Et);return n.formatDistance("xMonths",g,c)}else{const g=u%12,x=Math.trunc(u/12);return g<3?n.formatDistance("aboutXYears",x,c):g<9?n.formatDistance("overXYears",x,c):n.formatDistance("almostXYears",x+1,c)}}var ba=O("<span><span><!></span><span><!></span><span><!></span></span>");function ya(e,t){G(t,!0);const a=T(t,"running",3,!0);var s=ba();et(s,d=>({...t.attrs,class:`pending_animation ${t.attrs?.class??""}`,[de]:d}),[()=>({running:a(),display_flex:!t.inline,display_inline_flex:t.inline,align_items_center:t.inline})],void 0,"svelte-18ylyg9");var n=f(s);et(n,()=>({...t.item_attrs,[ht]:{"animation-delay":"0s"}}),void 0,void 0,"svelte-18ylyg9");var o=f(n);{var l=d=>{var D=J(),A=N(D);z(A,()=>t.children,()=>0),b(d,D)},c=d=>{var D=at("•");b(d,D)};S(o,d=>{t.children?d(l):d(c,!1)})}_(n);var i=M(n);et(i,()=>({...t.item_attrs,[ht]:{"animation-delay":"0.09s"}}),void 0,void 0,"svelte-18ylyg9");var m=f(i);{var v=d=>{var D=J(),A=N(D);z(A,()=>t.children,()=>1),b(d,D)},y=d=>{var D=at("•");b(d,D)};S(m,d=>{t.children?d(v):d(y,!1)})}_(i);var h=M(i);et(h,()=>({...t.item_attrs,[ht]:{"animation-delay":"0.3s"}}),void 0,void 0,"svelte-18ylyg9");var u=f(h);{var g=d=>{var D=J(),A=N(D);z(A,()=>t.children,()=>2),b(d,D)},x=d=>{var D=at("•");b(d,D)};S(u,d=>{t.children?d(g):d(x,!1)})}_(h),_(s),b(e,s),K()}var wa=O('<span class="animation svelte-cvss5b"><!></span>'),xa=O('<button><span class="content svelte-cvss5b"><!></span> <!></button>');function Da(e,t){G(t,!0);let a=Bt(void 0);var n={focus:v=>r(a)?.focus(v)},o=xa();et(o,v=>({type:"button",...t.attrs,disabled:t.disabled??t.attrs?.disabled??t.pending,title:t.title??t.attrs?.title,onclick:t.onclick,[de]:v}),[()=>({pending:t.pending})],void 0,"svelte-cvss5b");var l=f(o),c=f(l);z(c,()=>t.children),_(l);var i=M(l,2);{var m=v=>{var y=wa(),h=f(y);{var u=x=>{var d=J(),D=N(d);z(D,()=>t.animation),b(x,d)},g=x=>{ya(x,{get running(){return t.running}})};S(h,x=>{t.animation?x(u):x(g,!1)})}_(y),b(v,y)};S(i,v=>{t.pending&&v(m)})}return _(o),We(o,v=>ie(a,v),()=>r(a)),b(e,o),K(n)}const ka=(e,t)=>{let a,s,n,o,l,c,i,m;const v=u=>{m=u,c=0,typeof u=="function"?(a=u,s=void 0,n=void 0,o=void 0):u&&(a=u.onintersect,s=u.ondisconnect,n=u.count,o=u.options),y()},y=()=>{i&&h(),!(m===null||n===0)&&(i=new IntersectionObserver(u=>{l=u[0].isIntersecting,a&&i&&a({intersecting:l,intersections:c,el:e,observer:i,disconnect:h}),l?c++:n&&n>0&&c>=n&&h()},o),i.observe(e))},h=()=>{i&&(i.disconnect(),s&&s({intersecting:l,intersections:c,el:e,observer:i}),i=null)};return v(t),{update:u=>{v(u)},destroy:h}};var Ma=O('<div class="content panel p_md mb_lg svelte-1nc1gfs"><!></div>'),Ea=O("<details><summary> </summary><!></details>"),Ia=O('<div class="mastodon_status_item svelte-1nc1gfs"><header class="svelte-1nc1gfs"><button type="button" class="avatar plain icon_button svelte-1nc1gfs"><img class="icon svelte-1nc1gfs"/></button> <div class="names svelte-1nc1gfs"><div class="name svelte-1nc1gfs"><a> </a></div> <small class="svelte-1nc1gfs"> </small> <small class="date svelte-1nc1gfs"><a class="svelte-1nc1gfs"> </a></small></div></header> <!> <div class="content svelte-1nc1gfs"><!></div></div>');function Yt(e,t){G(t,!0);const a=w(()=>t.item.created_at),s=w(()=>t.item.edited_at),n=w(()=>t.item.content),o=w(()=>t.item.account),l=w(()=>t.item.url),c=w(()=>t.item.sensitive),i=w(()=>t.item.spoiler_text),m=w(()=>r(o).created_at),v=w(()=>r(o).avatar_static),y=w(()=>r(o).url),h=w(()=>r(o).display_name),u=w(()=>r(o).followers_count),g=w(()=>r(o).following_count),x=w(()=>r(o).acct),d=w(()=>r(o).note),D=w(()=>Ft(new Date(r(m)),"PPpp")),A=w(()=>$t(new Date,new Date(r(a)))),I=w(()=>r(s)?Ft(new Date(r(s)),"PPpp"):null),H=w(()=>r(s)?$t(new Date,new Date(r(s))):null),X=w(()=>Ft(new Date(r(m)),"MMM yyyy"));let L=Bt(!1);const U=()=>{ie(L,!r(L))};var F=Ia(),P=f(F),j=f(P);j.__click=function(...C){(r(d)?U:void 0)?.apply(this,C)};var Q=f(j);_(j);var _t=M(j,2),nt=f(_t),st=f(nt),St=f(st,!0);_(st),_(nt);var rt=M(nt,2),ot=f(rt,!0);_(rt);var ct=M(rt,2),it=f(ct),gt=f(it);_(it),_(ct),_(_t),_(P);var bt=M(P,2);{var vt=C=>{var R=Ma(),q=f(R);Lt(q,()=>r(d)),_(R),W(3,R,()=>$),b(C,R)};S(bt,C=>{r(L)&&r(d)&&C(vt)})}var ft=M(bt,2),Tt=f(ft);{var jt=C=>{var R=Ea(),q=f(R),Pt=f(q,!0);_(q);var yt=M(q);Lt(yt,()=>r(n)),_(R),B(()=>tt(Pt,r(i)||"view sensitive content")),b(C,R)},At=C=>{var R=J(),q=N(R);Lt(q,()=>r(n)),b(C,R)};S(Tt,C=>{r(c)?C(jt):C(At,!1)})}_(ft),_(F),B(C=>{Y(j,"title",r(d)?`${r(L)?"hide":"show"} ${r(x)}'s profile`:void 0),j.disabled=!r(d),Y(j,"aria-label",r(d)?`${r(L)?"hide":"show"} ${r(x)}'s profile`:void 0),Y(Q,"src",r(v)),Y(Q,"alt",`avatar for ${r(x)??""}`),Y(st,"href",r(y)),Y(st,"title",C),tt(St,r(h)),Y(rt,"title",`following ${r(g)??""}, ${r(u)??""} followers`),tt(ot,r(x)),Y(ct,"title",`posted ${r(D)??""}${r(I)?`, edited ${r(I)}`:""}, joined ${r(X)??""}`),Y(it,"href",r(l)),tt(gt,`${r(A)??""} ago${r(H)?`, edited ${r(H)} ago`:""}`)},[()=>Ge(r(y),"https://")]),b(e,F),K()}le(["click"]);var Oa=O('<li class="svelte-7gwsg1"><!> <!></li>'),Sa=O('<ul class="mastodon_status_tree unstyled svelte-7gwsg1"></ul>');function fe(e,t){G(t,!0);const a=w(()=>t.item.id),s=w(()=>t.items.filter(c=>c.in_reply_to_id===r(a)));var n=J(),o=N(n);{var l=c=>{var i=Sa();ve(i,21,()=>r(s),m=>m.id,(m,v)=>{var y=Oa(),h=f(y);Yt(h,{get item(){return r(v)}});var u=M(h,2);fe(u,{get item(){return r(v)},get items(){return t.items}}),_(y),b(m,y)}),_(i),b(c,i)};S(o,c=>{r(s).length&&c(l)})}b(e,n),K()}const Ta=e=>e?e.constructor===Object||e.constructor===void 0:!1,ja=Object.freeze({}),me=e=>!e||!Ta(e)?e:Object.fromEntries(Object.entries(e).sort((t,a)=>t[0]>a[0]?1:-1).map(([t,a])=>[t,me(a)])),te="application/vnd.github+json",Aa="2022-11-28",qt=async(e,t)=>{const{request:a,params:s,parse:n,token:o,cache:l,return_early_from_cache:c,log:i,fetch:m=globalThis.fetch}=t??ja,v=typeof e=="string"?new URL(e):e,y=v.href,h=a?.method??(s?"POST":"GET");let u,g;if(l&&(g=Ha(y,s,h),u=l.get(g),c&&u))return i?.info("[fetch_value] cached locally and returning early",y),i?.debug("[fetch_value] cached value",u),{ok:!0,value:u.value,headers:ee(u)};const x=a?.body??(h==="GET"||h==="HEAD"?null:JSON.stringify(s??{})),d=new Headers(a?.headers);d.has("accept")||d.set("accept",v.hostname==="api.github.com"?te:"application/json"),d.get("accept")===te&&!d.has("x-github-api-version")&&d.set("x-github-api-version",Aa),x&&!d.has("content-type")&&d.set("content-type","application/json"),o&&!d.has("authorization")&&d.set("authorization","Bearer "+o);const D=u?.etag;if(D&&!d.has("if-none-match"))d.set("if-none-match",D);else{const U=u?.last_modified;U&&!d.has("if-modified-since")&&d.set("if-modified-since",U)}const A=new Request(v,{...a,headers:d,method:h,body:x});i?.info("[fetch_value] fetching url with headers",e),i?.debug("[fetch_value] fetching with headers",Pa(d));const I=await m(A);if(i?.info("[fetch_value] fetched",e,I.status,pa(I.headers)),i?.debug("[fetch_value] fetched",Object.fromEntries(I.headers.entries())),I.status===429)throw Error("ratelimited exceeded fetching url "+e);if(I.status===304){if(!u)throw Error("unexpected 304 status without a cached value");return i?.info("[fetch_value] cache hit",e),{ok:!0,value:u.value,headers:ee(u)}}if(!I.ok)return{ok:!1,status:I.status,message:I.statusText};const H=I.headers.get("content-type"),X=await(!H||H.includes("json")?I.json():I.text()),L=n?n(X):X;if(i?.debug("[fetch_value] fetched json",e,L),g){const U={key:g,url:y,params:s,value:L,etag:I.headers.get("etag"),last_modified:I.headers.get("etag")?null:I.headers.get("last-modified")};l.set(g,U)}return{ok:!0,value:L,headers:I.headers}},ee=e=>{const t=new Headers;return e.etag&&t.set("etag",e.etag),e.last_modified&&t.set("last-modified",e.last_modified),t},Pa=e=>{const t=Object.fromEntries(e.entries());return t.authorization&&(t.authorization="[REDACTED]"),t},pa=e=>{const t=e.get("x-ratelimit-limit"),a=e.get("x-ratelimit-remaining");return t||a?`ratelimit ${a} of ${t}`:""},he=It(),Ca=aa({key:he,url:It(),params:Wt(),value:Wt(),etag:It().nullable(),last_modified:It().nullable()});na(he,Ca);const ae="::",Ha=(e,t,a)=>{let s=a+ae+e;return t!=null&&(s+=ae+JSON.stringify(me(t))),s};class La extends Error{constructor(t,a=`Unreachable case: ${t}`,s){super(a,s)}}const Fa=e=>Array.isArray(e)?e:[e],Ra=(e,t)=>`https://${e}/api/v1/statuses/${t}`,za=(e,t)=>`https://${e}/api/v1/statuses/${t}/context`,Ua=(e,t)=>`https://${e}/api/v1/statuses/${t}/favourited_by`,ge=e=>{try{const t=new URL(e),a=Ke(t.pathname,"/context").split("/").filter(Boolean),s=a[0][0]==="@"?a[0].substring(1):null;if(!s)return null;const n=a.length>1?a[a.length-1]:null;return n?{href:e,host:t.host,author:s,status_id:n}:null}catch{return null}},Ya=async(e,t,a,s,n,o,l)=>{const c=za(e,t),i=await qt(c,{request:n,token:o,cache:a,return_early_from_cache:Nt,log:s,fetch:l});return i.ok?i.value:null},Ba=async(e,t,a,s,n,o,l)=>{const c=Ra(e,t),i=await qt(c,{request:n,token:o,cache:a,return_early_from_cache:Nt,log:s,fetch:l});return i.ok?i.value:null},Na=async(e,t,a,s,n,o,l)=>{const c=Ua(e,t),i=await qt(c,{request:n,token:o,cache:a,return_early_from_cache:Nt,log:s,fetch:l});return i.ok?i.value:null},Xa=async(e,t,a,s,n)=>{const o=a?Fa(a):null,l=t.descendants;if(!l.length||!o?.length)return[];const c=new URL(e.url).host,i=new Set;for(const m of l)for(const v of o)if(v.type==="favourited_by"){if(!m.favourites_count)continue;if((await Na(c,m.id,s,n))?.find(u=>v.favourited_by.includes(u.acct))){i.add(m.id);break}}else if(v.type==="minimum_favourites"){if(m.favourites_count>=v.minimum_favourites){i.add(m.id);break}}else if(v.type==="custom"){if(v.should_include(m,e,t)){i.add(m.id);break}}else throw new La(v);return l.filter(m=>i.has(m.id)?m:null)};function qa(e,t){G(t,!0);let a=T(t,"include_ancestors",3,!1),s=T(t,"include_replies",3,!1),n=T(t,"loading",15),o=T(t,"item",15),l=T(t,"status_context",15),c=T(t,"replies",15),i=T(t,"load_time",15);const m=w(()=>a()||s()),v=w(()=>t.reply_filter===void 0?s()?{type:"custom",should_include:()=>!0}:null:t.reply_filter),y=async()=>{if(!t.host||!t.id)return;const g=performance.now();n(!0),await(async x=>{var d=Ne(x,2);o(d[0]),l(d[1])})(await Promise.all([Ba(t.host,t.id,t.cache,t.log),r(m)?Ya(t.host,t.id,t.cache,t.log):null])),o()&&l()?c(await Xa(o(),l(),typeof r(v)=="function"?r(v)(o(),l()):r(v),t.cache,t.log)):c(null),n(!1),i(performance.now()-g)};var h=J(),u=N(h);z(u,()=>t.children,()=>({item:o(),status_context:l(),replies:c(),load:y,loading:n(),load_time:i()})),b(e,h),K()}const ne=(e,t,a)=>{try{const s=localStorage.getItem(e);if(!s)return t();const n=JSON.parse(s);return a?.(n),n}catch{try{localStorage.removeItem(e)}catch{}return t()}},se=(e,t)=>{try{t===void 0?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(t))}catch{}},re={inform:{color:"var(--text_color_3)",icon:"✻"},help:{color:"var(--color_b_5)",icon:"➺"},error:{color:"var(--color_c_5)",icon:"!?"}};var Va=O('<div class="icon svelte-jpgxud"><!></div>'),Ja=O('<!> <div class="content svelte-jpgxud"><!></div>',1),Ga=O("<button><!></button>"),Ka=O("<div><!></div>");function Qa(e,t){G(t,!0);const a=u=>{var g=Ja(),x=N(g);{var d=I=>{var H=Va(),X=f(H);{var L=F=>{var P=at();B(()=>tt(P,r(i))),b(F,P)},U=F=>{var P=J(),j=N(P);z(j,()=>t.icon,()=>r(i)),b(F,P)};S(X,F=>{!t.icon||typeof t.icon=="string"?F(L):F(U,!1)})}_(H),b(I,H)};S(x,I=>{t.icon!==null&&I(d)})}var D=M(x,2),A=f(D);z(A,()=>t.children),_(D),b(u,g)},s=T(t,"status",3,"inform"),n=w(()=>re[s()]),o=w(()=>r(n).color),l=w(()=>r(n).icon),c=w(()=>t.color??r(o)),i=w(()=>typeof t.icon=="string"?t.icon:r(l)??re.inform.icon);var m=J(),v=N(m);{var y=u=>{var g=Ga();et(g,d=>({class:"message",type:"button",onclick:t.onclick,disabled:t.disabled,...t.attrs,[ht]:d}),[()=>({"--text_color":r(c)})],void 0,"svelte-jpgxud");var x=f(g);a(x),_(g),b(u,g)},h=u=>{var g=Ka();et(g,d=>({role:"alert",class:"message panel",...t.attrs,[ht]:d}),[()=>({"--text_color":r(c)})],void 0,"svelte-jpgxud");var x=f(g);a(x),_(g),b(u,g)};S(v,u=>{t.onclick?u(y):u(h,!1)})}b(e,m),K()}var Za=O("<div><!></div>"),Wa=O('<fieldset><div><label title="where to load the toot" class="flex_1 row"><a class="icon_button box mr_lg">🔗</a> <input/></label></div> <!></fieldset>');function $a(e,t){G(t,!0);let a=T(t,"url",15);const s=w(()=>ge(a())),n=w(()=>!!(a()&&!r(s)));var o=Wa(),l=f(o);let c;var i=f(l),m=f(i);ue(m,"",{},{"font-size":"var(--font_size_xl)"});var v=M(m,2);_e(v);var y=g=>g.currentTarget.select();et(v,()=>({placeholder:"> toot url",onfocus:y,...t.attrs})),_(i),_(l);var h=M(l,2);{var u=g=>{var x=Za(),d=f(x);Qa(d,{status:"error",children:(D,A)=>{zt();var I=at("invalid Mastodon status url");b(D,I)},$$slots:{default:!0}}),_(x),W(3,x,()=>$),b(g,x)};S(h,g=>{r(n)&&g(u)})}_(o),B(g=>{c=Ut(l,1,"row",null,c,g),Y(m,"href",a()||void 0)},[()=>({mb_lg:r(n)})]),Qe(v,a),b(e,o),K()}const tn=(e,t)=>{t(!t())};var en=O("<div></div>"),an=O('<div class="transition_wrapper svelte-esn2at"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),nn=O('<div class="icon_button_content svelte-esn2at"><div class="icon svelte-esn2at">🦣</div> <div class="button_content svelte-esn2at"><div>load toot<!> from</div> <code class="ellipsis"><!></code></div></div>'),sn=O('<div class="transition_wrapper svelte-esn2at"><!></div>'),rn=O('<div class="pb_md"><a rel="noreferrer" class="display_block panel p_md"><span class="font_family_mono">↪︎</span> reply on Mastodon</a></div>'),on=O('<div class="loaded_message svelte-esn2at"> </div>'),ln=O(`<div class="settings controls panel svelte-esn2at"><form class="w_100"><div class="mb_lg"><!></div> <fieldset class="row"><label class="row"><input type="checkbox"/>automatically load when
										scrolled onscreen</label></fieldset></form> <!></div>`),cn=O('<div><div class="toot_content svelte-esn2at"><!> <div class="main_post panel svelte-esn2at"><div class="panel bg_panel svelte-esn2at"><!></div></div> <!></div> <!> <div class="toot_controls svelte-esn2at"><div class="controls svelte-esn2at"><div class="row"><button type="button">settings</button> <div class="reset svelte-esn2at"><button type="button">reset</button><!></div></div></div> <!></div></div>');function dn(e,t){G(t,!0);let a=T(t,"updated_url",31,()=>Xe(t.url)),s=T(t,"include_ancestors",3,!1),n=T(t,"include_replies",3,!1),o=T(t,"loading",15),l=T(t,"load_time",15),c=T(t,"initial_show_settings",3,!1),i=T(t,"show_settings",15),m=T(t,"autoload_storage_key",3,"autoload"),v=T(t,"initial_autoload",3,!1),y=T(t,"autoload",23,()=>m()?ne(m(),()=>v()):v()),h=Bt(1);const u=()=>{qe(h),a(t.url),o(void 0),l(void 0),t.onreset?.()},g=w(()=>t.settings_storage_key&&"show_settings"+t.settings_storage_key);Ht(()=>{i()===void 0&&i(r(g)?ne(r(g),()=>c()):c())}),Ht(()=>{r(g)&&se(r(g),i())}),Ht(()=>{m()&&se(m(),y())});const x=w(()=>ge(a())),d=w(()=>r(x)?.status_id??null),D=w(()=>r(x)?.host??null),A=w(()=>o()!==!1&&!!r(D)),I=w(()=>o()!==void 0||a()!==t.url);var H={reset:u},X=J(),L=N(X);return oa(L,()=>r(h),U=>{qa(U,{get host(){return r(D)},get id(){return r(d)},get include_ancestors(){return s()},get include_replies(){return n()},get cache(){return t.cache},get log(){return t.log},get reply_filter(){return t.reply_filter},get loading(){return o()},set loading(P){o(P)},get load_time(){return l()},set load_time(P){l(P)},children:(P,j)=>{let Q=()=>j?.().item,_t=()=>j?.().status_context,nt=()=>j?.().replies,st=()=>j?.().load,St=()=>j?.().loading,rt=()=>j?.().load_time;var ot=cn();let ct;var it=f(ot),gt=f(it);{var bt=E=>{var k=en();ve(k,21,()=>_t().ancestors,p=>p.id,(p,Z)=>{Yt(p,{get item(){return r(Z)}})}),_(k),W(3,k,()=>$),b(E,k)};S(gt,E=>{s()&&_t()&&E(bt)})}var vt=M(gt,2),ft=f(vt),Tt=f(ft);{var jt=E=>{var k=an(),p=f(k);ia(p,()=>({"--margin":"0"})),Yt(p.lastChild,{get item(){return Q()}}),_(p),_(k),W(3,k,()=>$),b(E,k)},At=E=>{var k=sn(),p=f(k);{let Z=w(()=>St()||!1),Ct=w(()=>!r(A));Da(p,{get pending(){return r(Z)},get disabled(){return r(Ct)},onclick:()=>st()(),children:(Dt,kt)=>{var dt=nn(),Mt=M(f(dt),2),mt=f(Mt),De=M(f(mt));{var ke=V=>{var ut=at("s");b(V,ut)};S(De,V=>{(n()||s())&&V(ke)})}zt(),_(mt);var Kt=M(mt,2),Me=f(Kt);{var Ee=V=>{var ut=at();B(()=>tt(ut,r(D))),b(V,ut)},Ie=V=>{var ut=at("invalid url");b(V,ut)};S(Me,V=>{r(D)?V(Ee):V(Ie,!1)})}_(Kt),_(Mt),_(dt),b(Dt,dt)},$$slots:{default:!0}})}_(k),W(3,k,()=>$),b(E,k)};S(Tt,E=>{Q()?E(jt):E(At,!1)})}_(ft),_(vt);var C=M(vt,2);{var R=E=>{fe(E,{get item(){return Q()},get items(){return nt()}})};S(C,E=>{Q()&&nt()&&E(R)})}_(it);var q=M(it,2);{var Pt=E=>{var k=rn(),p=f(k);_(k),B(()=>Y(p,"href",Q().url)),W(3,k,()=>$),b(E,k)};S(q,E=>{Q()&&E(Pt)})}var yt=M(q,2),wt=f(yt),Vt=f(wt),xt=f(Vt);xt.__click=[tn,i];let Jt;ue(xt,"",{},{"margin-right":"var(--space_sm)"});var Gt=M(xt,2),pt=f(Gt);pt.__click=u;var be=M(pt);{var ye=E=>{var k=on(),p=f(k);_(k),B(Z=>tt(p,`loaded in ${Z??""}ms`),[()=>Math.round(rt())]),W(3,k,()=>$),b(E,k)};S(be,E=>{rt()!==void 0&&E(ye)})}_(Gt),_(Vt),_(wt),la(wt,(E,k)=>ka?.(E,k),()=>({onintersect:({intersecting:E})=>{E&&y()&&st()()},count:1}));var we=M(wt,2);{var xe=E=>{var k=ln(),p=f(k),Z=f(p),Ct=f(Z);$a(Ct,{get url(){return a()},set url(mt){a(mt)}}),_(Z);var Dt=M(Z,2),kt=f(Dt),dt=f(kt);_e(dt),zt(),_(kt),_(Dt),_(p);var Mt=M(p,2);z(Mt,()=>t.settings??ce),_(k),B(()=>Y(kt,"title",y()?"replies will load automatically when scrolled intersect":"replies are not loaded until you request them")),Ze(dt,y),W(3,k,()=>$),b(E,k)};S(we,E=>{i()&&E(xe)})}_(yt),_(ot),B((E,k)=>{ct=Ut(ot,1,"toot svelte-esn2at",null,ct,E),Jt=Ut(xt,1,"deselectable",null,Jt,k),pt.disabled=!r(I)},[()=>({replies:nt()}),()=>({selected:i()})]),W(3,ot,()=>$),b(P,ot)},$$slots:{default:!0}})}),b(e,X),K(H)}le(["click"]);var un=O('<header><h1 class="mt_xl5 mb_lg"> </h1> <p class="mb_xl5"><!></p></header>');function _n(e,t){G(t,!0);var a=un(),s=f(a),n=f(s,!0);_(s);var o=M(s,2),l=f(o);ea(l,{get item(){return t.item}}),_(o),_(a),B(()=>tt(n,t.item.title)),b(e,a),K()}const vn=e=>{var t=fn();b(e,t)};var fn=O("<hr/>"),mn=O("<!>  <section><h2>Comments</h2> <!></section> <!>",1),hn=O("<article><!> <!> <!> <!></article>"),gn=O("<div>cannot find post <code> </code></div>"),bn=O('<div class="blog_post width_md"><!></div>');function Cn(e,t){G(t,!0);const a=T(t,"separator",3,vn),n=ra.get().items.find(v=>v.slug===t.post.slug),o=ca.maybe_get();var l=bn();Ve(v=>{B(()=>Je.title=t.post.title)});var c=f(l);{var i=v=>{var y=hn();et(y,()=>({...t.attrs}));var h=f(y);_n(h,{get item(){return n}});var u=M(h,2);z(u,()=>t.children);var g=M(u,2);z(g,()=>t.footer??ce);var x=M(g,2);{var d=D=>{var A=mn(),I=N(A);z(I,a);var H=M(I,2),X=M(f(H),2);{var L=F=>{{let P=w(()=>o?.data);dn(F,{get url(){return n.comments.url},include_replies:!0,initial_autoload:!0,reply_filter:j=>({type:"favourited_by",favourited_by:[j.account.acct]}),get settings_storage_key(){return`${n.id??""}_comments_settings`},get cache(){return r(P)}})}};S(X,F=>{(!o||o.data!==void 0)&&F(L)})}_(H);var U=M(H,2);z(U,a),b(D,A)};S(x,D=>{n.comments&&D(d)})}_(y),b(v,y)},m=v=>{var y=gn(),h=M(f(y)),u=f(h,!0);_(h),_(y),B(()=>tt(u,t.post.slug)),b(v,y)};S(c,v=>{n?v(i):v(m,!1)})}_(l),b(e,l),K()}export{Cn as B};
