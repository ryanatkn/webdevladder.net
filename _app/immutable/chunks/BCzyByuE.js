import"./DsnmJJEf.js";import{h as Lt,g as Se,e as Oe,bg as Te,o as je,k as Ae,S as Pe,a7 as pe,i as He,a6 as Re,w as Ce,u as Fe,n as Le,R as oe,U as Ue,H as ze,bh as Ye,bi as Ne,p as G,f as S,d as f,r as _,s as M,b,c as K,am as V,a as B,ak as at,ao as r,aV as Nt,au as ie,ap as w,t as N,b6 as le,bj as Bt,bk as Be,al as Ut,at as Xe,A as Rt,bl as qe,a2 as ce,be as Je,bf as Ve}from"./DfYgWjWz.js";import{s as tt}from"./CdrrQQDf.js";import{s as U}from"./XLr6r3nC.js";import{i as O}from"./CUsIZ9C-.js";import{a as et,C as de,S as ht,s as Y,c as ue,r as _e,b as zt}from"./DCQDJNVC.js";import{p as T}from"./Bn-03FR_.js";import{s as Ge,e as ve,b as Ke}from"./DjQIghkw.js";import{t as W,s as $}from"./B1VAgOC1.js";import{b as Ze,a as Qe}from"./KTwgZVPL.js";import{b as We}from"./Snw1ZUFY.js";import{h as Ct}from"./-GEYTWQF.js";import{a as lt,n as Xt,g as Zt,b as $e,e as ta,m as Qt,c as It,f as Ft,F as ea}from"./DzXWjjst.js";import{s as Et,o as aa,a as Wt,m as na}from"./C-_V8m2x.js";import{c as sa,b as ra}from"./DDQn1V_I.js";function oa(e,t,a){Lt&&Se();var s=e,n=Re,o,l,c=null,i=Te;function m(){o&&Ce(o),c!==null&&(c.lastChild.remove(),s.before(c),c=null),o=l}Oe(()=>{if(i(n,n=t())){var v=s,y=pe();y&&(c=document.createDocumentFragment(),c.append(v=je())),l=Ae(()=>a(v)),y?Pe.add_callback(m):m()}}),Lt&&(s=He)}function ia(e,t){Lt&&Fe(Le(e)),oe(()=>{var a=t();for(var s in a){var n=a[s];n?e.style.setProperty(s,n):e.style.removeProperty(s)}})}function la(e,t,a){Ue(()=>{var s=ze(()=>t(e,a?.())||{});if(a&&s?.update){var n=!1,o={};oe(()=>{var l=a();Ye(l),n&&Ne(o,l)&&(o=l,s.update(l))}),n=!0}if(s?.destroy)return()=>s.destroy()})}const ca=sa();function St(e,t){const a=+lt(e)-+lt(t);return a<0?-1:a>0?1:a}function da(e,t,a){const[s,n]=Xt(a?.in,e,t),o=s.getFullYear()-n.getFullYear(),l=s.getMonth()-n.getMonth();return o*12+l}function ua(e){return t=>{const a=Math.trunc,s=a(t);return s===0?0:s}}function _a(e,t){return+lt(e)-+lt(t)}function va(e,t){const a=lt(e,t?.in);return a.setHours(23,59,59,999),a}function fa(e,t){const a=lt(e,t?.in),s=a.getMonth();return a.setFullYear(a.getFullYear(),s+1,0),a.setHours(23,59,59,999),a}function ma(e,t){const a=lt(e,t?.in);return+va(a,t)==+fa(a,t)}function ha(e,t,a){const[s,n,o]=Xt(a?.in,e,e,t),l=St(n,o),c=Math.abs(da(n,o));if(c<1)return 0;n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-l*c);let i=St(n,o)===-l;ma(s)&&c===1&&St(s,o)===1&&(i=!1);const m=l*(c-+i);return m===0?0:m}function ga(e,t,a){const s=_a(e,t)/1e3;return ua()(s)}function $t(e,t,a){const s=$e(),n=a?.locale??s.locale??ta,o=2520,l=St(e,t);if(isNaN(l))throw new RangeError("Invalid time value");const c=Object.assign({},a,{addSuffix:a?.addSuffix,comparison:l}),[i,m]=Xt(a?.in,...l>0?[t,e]:[e,t]),v=ga(m,i),y=(Zt(m)-Zt(i))/1e3,h=Math.round((v-y)/60);let u;if(h<2)return h===0?n.formatDistance("lessThanXMinutes",1,c):n.formatDistance("xMinutes",h,c);if(h<45)return n.formatDistance("xMinutes",h,c);if(h<90)return n.formatDistance("aboutXHours",1,c);if(h<Qt){const g=Math.round(h/60);return n.formatDistance("aboutXHours",g,c)}else{if(h<o)return n.formatDistance("xDays",1,c);if(h<It){const g=Math.round(h/Qt);return n.formatDistance("xDays",g,c)}else if(h<It*2)return u=Math.round(h/It),n.formatDistance("aboutXMonths",u,c)}if(u=ha(m,i),u<12){const g=Math.round(h/It);return n.formatDistance("xMonths",g,c)}else{const g=u%12,x=Math.trunc(u/12);return g<3?n.formatDistance("aboutXYears",x,c):g<9?n.formatDistance("overXYears",x,c):n.formatDistance("almostXYears",x+1,c)}}var ba=S("<span><span><!></span><span><!></span><span><!></span></span>");function ya(e,t){G(t,!0);const a=T(t,"running",3,!0);var s=ba();et(s,d=>({...t.attrs,class:`pending_animation ${t.attrs?.class??""}`,[de]:d}),[()=>({running:a(),display_flex:!t.inline,display_inline_flex:t.inline,align_items_center:t.inline})],void 0,"svelte-18ylyg9");var n=f(s);et(n,()=>({...t.item_attrs,[ht]:{"animation-delay":"0s"}}),void 0,void 0,"svelte-18ylyg9");var o=f(n);{var l=d=>{var D=V(),A=B(D);U(A,()=>t.children,()=>0),b(d,D)},c=d=>{var D=at("•");b(d,D)};O(o,d=>{t.children?d(l):d(c,!1)})}_(n);var i=M(n);et(i,()=>({...t.item_attrs,[ht]:{"animation-delay":"0.09s"}}),void 0,void 0,"svelte-18ylyg9");var m=f(i);{var v=d=>{var D=V(),A=B(D);U(A,()=>t.children,()=>1),b(d,D)},y=d=>{var D=at("•");b(d,D)};O(m,d=>{t.children?d(v):d(y,!1)})}_(i);var h=M(i);et(h,()=>({...t.item_attrs,[ht]:{"animation-delay":"0.3s"}}),void 0,void 0,"svelte-18ylyg9");var u=f(h);{var g=d=>{var D=V(),A=B(D);U(A,()=>t.children,()=>2),b(d,D)},x=d=>{var D=at("•");b(d,D)};O(u,d=>{t.children?d(g):d(x,!1)})}_(h),_(s),b(e,s),K()}var wa=S('<span class="animation svelte-cvss5b"><!></span>'),xa=S('<button><span class="content svelte-cvss5b"><!></span> <!></button>');function Da(e,t){G(t,!0);let a=Nt(void 0);var n={focus:v=>r(a)?.focus(v)},o=xa();et(o,v=>({type:"button",...t.attrs,disabled:t.disabled??t.attrs?.disabled??t.pending,title:t.title??t.attrs?.title,onclick:t.onclick,[de]:v}),[()=>({pending:t.pending})],void 0,"svelte-cvss5b");var l=f(o),c=f(l);U(c,()=>t.children),_(l);var i=M(l,2);{var m=v=>{var y=wa(),h=f(y);{var u=x=>{var d=V(),D=B(d);U(D,()=>t.animation),b(x,d)},g=x=>{ya(x,{get running(){return t.running}})};O(h,x=>{t.animation?x(u):x(g,!1)})}_(y),b(v,y)};O(i,v=>{t.pending&&v(m)})}return _(o),We(o,v=>ie(a,v),()=>r(a)),b(e,o),K(n)}const ka=(e,t)=>{let a,s,n,o,l,c,i,m;const v=u=>{m=u,c=0,typeof u=="function"?(a=u,s=void 0,n=void 0,o=void 0):u&&(a=u.onintersect,s=u.ondisconnect,n=u.count,o=u.options),y()},y=()=>{i&&h(),!(m===null||n===0)&&(i=new IntersectionObserver(u=>{l=u[0].isIntersecting,a&&i&&a({intersecting:l,intersections:c,el:e,observer:i,disconnect:h}),l?c++:n&&n>0&&c>=n&&h()},o),i.observe(e))},h=()=>{i&&(i.disconnect(),s&&s({intersecting:l,intersections:c,el:e,observer:i}),i=null)};return v(t),{update:u=>{v(u)},destroy:h}};var Ma=S('<div class="content panel p_md mb_lg svelte-1nc1gfs"><!></div>'),Ia=S("<details><summary> </summary><!></details>"),Ea=S('<div class="mastodon_status_item svelte-1nc1gfs"><header class="svelte-1nc1gfs"><button type="button" class="avatar plain icon_button svelte-1nc1gfs"><img class="icon svelte-1nc1gfs"/></button> <div class="names svelte-1nc1gfs"><div class="name svelte-1nc1gfs"><a> </a></div> <small class="svelte-1nc1gfs"> </small> <small class="date svelte-1nc1gfs"><a class="svelte-1nc1gfs"> </a></small></div></header> <!> <div class="content svelte-1nc1gfs"><!></div></div>');function Yt(e,t){G(t,!0);const a=w(()=>t.item.created_at),s=w(()=>t.item.edited_at),n=w(()=>t.item.content),o=w(()=>t.item.account),l=w(()=>t.item.url),c=w(()=>t.item.sensitive),i=w(()=>t.item.spoiler_text),m=w(()=>r(o).created_at),v=w(()=>r(o).avatar_static),y=w(()=>r(o).url),h=w(()=>r(o).display_name),u=w(()=>r(o).followers_count),g=w(()=>r(o).following_count),x=w(()=>r(o).acct),d=w(()=>r(o).note),D=w(()=>Ft(new Date(r(m)),"PPpp")),A=w(()=>$t(new Date,new Date(r(a)))),E=w(()=>r(s)?Ft(new Date(r(s)),"PPpp"):null),R=w(()=>r(s)?$t(new Date,new Date(r(s))):null),X=w(()=>Ft(new Date(r(m)),"MMM yyyy"));let C=Nt(!1);const z=()=>{ie(C,!r(C))};var F=Ea(),P=f(F),j=f(P);j.__click=function(...H){(r(d)?z:void 0)?.apply(this,H)};var Z=f(j);_(j);var _t=M(j,2),nt=f(_t),st=f(nt),Ot=f(st,!0);_(st),_(nt);var rt=M(nt,2),ot=f(rt,!0);_(rt);var ct=M(rt,2),it=f(ct),gt=f(it);_(it),_(ct),_(_t),_(P);var bt=M(P,2);{var vt=H=>{var L=Ma(),q=f(L);Ct(q,()=>r(d)),_(L),W(3,L,()=>$),b(H,L)};O(bt,H=>{r(C)&&r(d)&&H(vt)})}var ft=M(bt,2),Tt=f(ft);{var jt=H=>{var L=Ia(),q=f(L),Pt=f(q,!0);_(q);var yt=M(q);Ct(yt,()=>r(n)),_(L),N(()=>tt(Pt,r(i)||"view sensitive content")),b(H,L)},At=H=>{var L=V(),q=B(L);Ct(q,()=>r(n)),b(H,L)};O(Tt,H=>{r(c)?H(jt):H(At,!1)})}_(ft),_(F),N(H=>{Y(j,"title",r(d)?`${r(C)?"hide":"show"} ${r(x)}'s profile`:void 0),j.disabled=!r(d),Y(j,"aria-label",r(d)?`${r(C)?"hide":"show"} ${r(x)}'s profile`:void 0),Y(Z,"src",r(v)),Y(Z,"alt",`avatar for ${r(x)??""}`),Y(st,"href",r(y)),Y(st,"title",H),tt(Ot,r(h)),Y(rt,"title",`following ${r(g)??""}, ${r(u)??""} followers`),tt(ot,r(x)),Y(ct,"title",`posted ${r(D)??""}${r(E)?`, edited ${r(E)}`:""}, joined ${r(X)??""}`),Y(it,"href",r(l)),tt(gt,`${r(A)??""} ago${r(R)?`, edited ${r(R)} ago`:""}`)},[()=>Ge(r(y),"https://")]),b(e,F),K()}le(["click"]);var Sa=S('<li class="svelte-7gwsg1"><!> <!></li>'),Oa=S('<ul class="mastodon_status_tree unstyled svelte-7gwsg1"></ul>');function fe(e,t){G(t,!0);const a=w(()=>t.item.id),s=w(()=>t.items.filter(c=>c.in_reply_to_id===r(a)));var n=V(),o=B(n);{var l=c=>{var i=Oa();ve(i,21,()=>r(s),m=>m.id,(m,v)=>{var y=Sa(),h=f(y);Yt(h,{get item(){return r(v)}});var u=M(h,2);fe(u,{get item(){return r(v)},get items(){return t.items}}),_(y),b(m,y)}),_(i),b(c,i)};O(o,c=>{r(s).length&&c(l)})}b(e,n),K()}const Ta=e=>e?e.constructor===Object||e.constructor===void 0:!1,ja=Object.freeze({}),me=e=>!e||!Ta(e)?e:Object.fromEntries(Object.entries(e).sort((t,a)=>t[0]>a[0]?1:-1).map(([t,a])=>[t,me(a)])),te="application/vnd.github+json",Aa="2022-11-28",qt=async(e,t)=>{const{request:a,params:s,parse:n,token:o,cache:l,return_early_from_cache:c,log:i,fetch:m=globalThis.fetch}=t??ja,v=typeof e=="string"?new URL(e):e,y=v.href,h=a?.method??(s?"POST":"GET");let u,g;if(l&&(g=Ra(y,s,h),u=l.get(g),c&&u))return i?.info("[fetch_value] cached locally and returning early",y),i?.debug("[fetch_value] cached value",u),{ok:!0,value:u.value,headers:ee(u)};const x=a?.body??(h==="GET"||h==="HEAD"?null:JSON.stringify(s??{})),d=new Headers(a?.headers);d.has("accept")||d.set("accept",v.hostname==="api.github.com"?te:"application/json"),d.get("accept")===te&&!d.has("x-github-api-version")&&d.set("x-github-api-version",Aa),x&&!d.has("content-type")&&d.set("content-type","application/json"),o&&!d.has("authorization")&&d.set("authorization","Bearer "+o);const D=u?.etag;if(D&&!d.has("if-none-match"))d.set("if-none-match",D);else{const z=u?.last_modified;z&&!d.has("if-modified-since")&&d.set("if-modified-since",z)}const A=new Request(v,{...a,headers:d,method:h,body:x});i?.info("[fetch_value] fetching url with headers",e),i?.debug("[fetch_value] fetching with headers",Pa(d));const E=await m(A);if(i?.info("[fetch_value] fetched",e,E.status,pa(E.headers)),i?.debug("[fetch_value] fetched",Object.fromEntries(E.headers.entries())),E.status===429)throw Error("ratelimited exceeded fetching url "+e);if(E.status===304){if(!u)throw Error("unexpected 304 status without a cached value");return i?.info("[fetch_value] cache hit",e),{ok:!0,value:u.value,headers:ee(u)}}if(!E.ok)return{ok:!1,status:E.status,message:E.statusText};const R=E.headers.get("content-type"),X=await(!R||R.includes("json")?E.json():E.text()),C=n?n(X):X;if(i?.debug("[fetch_value] fetched json",e,C),g){const z={key:g,url:y,params:s,value:C,etag:E.headers.get("etag"),last_modified:E.headers.get("etag")?null:E.headers.get("last-modified")};l.set(g,z)}return{ok:!0,value:C,headers:E.headers}},ee=e=>{const t=new Headers;return e.etag&&t.set("etag",e.etag),e.last_modified&&t.set("last-modified",e.last_modified),t},Pa=e=>{const t=Object.fromEntries(e.entries());return t.authorization&&(t.authorization="[REDACTED]"),t},pa=e=>{const t=e.get("x-ratelimit-limit"),a=e.get("x-ratelimit-remaining");return t||a?`ratelimit ${a} of ${t}`:""},he=Et(),Ha=aa({key:he,url:Et(),params:Wt(),value:Wt(),etag:Et().nullable(),last_modified:Et().nullable()});na(he,Ha);const ae="::",Ra=(e,t,a)=>{let s=a+ae+e;return t!=null&&(s+=ae+JSON.stringify(me(t))),s};class Ca extends Error{constructor(t,a=`Unreachable case: ${t}`,s){super(a,s)}}const Fa=e=>Array.isArray(e)?e:[e],La=(e,t)=>`https://${e}/api/v1/statuses/${t}`,Ua=(e,t)=>`https://${e}/api/v1/statuses/${t}/context`,za=(e,t)=>`https://${e}/api/v1/statuses/${t}/favourited_by`,ge=e=>{try{const t=new URL(e),a=Ke(t.pathname,"/context").split("/").filter(Boolean),s=a[0][0]==="@"?a[0].substring(1):null;if(!s)return null;const n=a.length>1?a[a.length-1]:null;return n?{href:e,host:t.host,author:s,status_id:n}:null}catch{return null}},Ya=async(e,t,a,s,n,o,l)=>{const c=Ua(e,t),i=await qt(c,{request:n,token:o,cache:a,return_early_from_cache:Bt,log:s,fetch:l});return i.ok?i.value:null},Na=async(e,t,a,s,n,o,l)=>{const c=La(e,t),i=await qt(c,{request:n,token:o,cache:a,return_early_from_cache:Bt,log:s,fetch:l});return i.ok?i.value:null},Ba=async(e,t,a,s,n,o,l)=>{const c=za(e,t),i=await qt(c,{request:n,token:o,cache:a,return_early_from_cache:Bt,log:s,fetch:l});return i.ok?i.value:null},Xa=async(e,t,a,s,n)=>{const o=a?Fa(a):null,l=t.descendants;if(!l.length||!o?.length)return[];const c=new URL(e.url).host,i=new Set;for(const m of l)for(const v of o)if(v.type==="favourited_by"){if(!m.favourites_count)continue;if((await Ba(c,m.id,s,n))?.find(u=>v.favourited_by.includes(u.acct))){i.add(m.id);break}}else if(v.type==="minimum_favourites"){if(m.favourites_count>=v.minimum_favourites){i.add(m.id);break}}else if(v.type==="custom"){if(v.should_include(m,e,t)){i.add(m.id);break}}else throw new Ca(v);return l.filter(m=>i.has(m.id)?m:null)};function qa(e,t){G(t,!0);let a=T(t,"include_ancestors",3,!1),s=T(t,"include_replies",3,!1),n=T(t,"loading",15),o=T(t,"item",15),l=T(t,"status_context",15),c=T(t,"replies",15),i=T(t,"load_time",15);const m=w(()=>a()||s()),v=w(()=>t.reply_filter===void 0?s()?{type:"custom",should_include:()=>!0}:null:t.reply_filter),y=async()=>{if(!t.host||!t.id)return;const g=performance.now();n(!0),await(async x=>{var d=Be(x,2);o(d[0]),l(d[1])})(await Promise.all([Na(t.host,t.id,t.cache,t.log),r(m)?Ya(t.host,t.id,t.cache,t.log):null])),o()&&l()?c(await Xa(o(),l(),typeof r(v)=="function"?r(v)(o(),l()):r(v),t.cache,t.log)):c(null),n(!1),i(performance.now()-g)};var h=V(),u=B(h);U(u,()=>t.children,()=>({item:o(),status_context:l(),replies:c(),load:y,loading:n(),load_time:i()})),b(e,h),K()}const ne=(e,t,a)=>{try{const s=localStorage.getItem(e);if(!s)return t();const n=JSON.parse(s);return a?.(n),n}catch{try{localStorage.removeItem(e)}catch{}return t()}},se=(e,t)=>{try{t===void 0?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(t))}catch{}},re={inform:{color:"var(--text_color_3)",icon:"✻"},help:{color:"var(--color_b_5)",icon:"➺"},error:{color:"var(--color_c_5)",icon:"!?"}};var Ja=S('<div class="icon svelte-jpgxud"><!></div>'),Va=S('<!> <div class="content svelte-jpgxud"><!></div>',1),Ga=S("<button><!></button>"),Ka=S("<div><!></div>");function Za(e,t){G(t,!0);const a=u=>{var g=Va(),x=B(g);{var d=E=>{var R=Ja(),X=f(R);{var C=F=>{var P=at();N(()=>tt(P,r(i))),b(F,P)},z=F=>{var P=V(),j=B(P);U(j,()=>t.icon,()=>r(i)),b(F,P)};O(X,F=>{!t.icon||typeof t.icon=="string"?F(C):F(z,!1)})}_(R),b(E,R)};O(x,E=>{t.icon!==null&&E(d)})}var D=M(x,2),A=f(D);U(A,()=>t.children),_(D),b(u,g)},s=T(t,"status",3,"inform"),n=w(()=>re[s()]),o=w(()=>r(n).color),l=w(()=>r(n).icon),c=w(()=>t.color??r(o)),i=w(()=>typeof t.icon=="string"?t.icon:r(l)??re.inform.icon);var m=V(),v=B(m);{var y=u=>{var g=Ga();et(g,d=>({class:"message",type:"button",onclick:t.onclick,disabled:t.disabled,...t.attrs,[ht]:d}),[()=>({"--text_color":r(c)})],void 0,"svelte-jpgxud");var x=f(g);a(x),_(g),b(u,g)},h=u=>{var g=Ka();et(g,d=>({role:"alert",class:"message panel",...t.attrs,[ht]:d}),[()=>({"--text_color":r(c)})],void 0,"svelte-jpgxud");var x=f(g);a(x),_(g),b(u,g)};O(v,u=>{t.onclick?u(y):u(h,!1)})}b(e,m),K()}var Qa=S("<div><!></div>"),Wa=S('<fieldset><div><label title="where to load the toot" class="flex_1 row"><a class="icon_button box mr_lg">🔗</a> <input/></label></div> <!></fieldset>');function $a(e,t){G(t,!0);let a=T(t,"url",15);const s=w(()=>ge(a())),n=w(()=>!!(a()&&!r(s)));var o=Wa(),l=f(o);let c;var i=f(l),m=f(i);ue(m,"",{},{"font-size":"var(--font_size_xl)"});var v=M(m,2);_e(v);var y=g=>g.currentTarget.select();et(v,()=>({placeholder:"> toot url",onfocus:y,...t.attrs})),_(i),_(l);var h=M(l,2);{var u=g=>{var x=Qa(),d=f(x);Za(d,{status:"error",children:(D,A)=>{Ut();var E=at("invalid Mastodon status url");b(D,E)},$$slots:{default:!0}}),_(x),W(3,x,()=>$),b(g,x)};O(h,g=>{r(n)&&g(u)})}_(o),N(g=>{c=zt(l,1,"row",null,c,g),Y(m,"href",a()||void 0)},[()=>({mb_lg:r(n)})]),Ze(v,a),b(e,o),K()}const tn=(e,t)=>{t(!t())};var en=S("<div></div>"),an=S('<div class="transition_wrapper svelte-esn2at"><svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper></div>'),nn=S('<div class="icon_button_content svelte-esn2at"><div class="icon svelte-esn2at">🦣</div> <div class="button_content svelte-esn2at"><div>load toot<!> from</div> <code class="ellipsis"><!></code></div></div>'),sn=S('<div class="transition_wrapper svelte-esn2at"><!></div>'),rn=S('<div class="pb_md"><a rel="noreferrer" class="display_block panel p_md"><span class="font_family_mono">↪︎</span> reply on Mastodon</a></div>'),on=S('<div class="loaded_message svelte-esn2at"> </div>'),ln=S(`<div class="settings controls panel svelte-esn2at"><form class="width_100"><div class="mb_lg"><!></div> <fieldset class="row"><label class="row"><input type="checkbox"/>automatically load when
										scrolled onscreen</label></fieldset></form> <!></div>`),cn=S('<div><div class="toot_content svelte-esn2at"><!> <div class="main_post panel svelte-esn2at"><div class="panel bg_panel svelte-esn2at"><!></div></div> <!></div> <!> <div class="toot_controls svelte-esn2at"><div class="controls svelte-esn2at"><div class="row"><button type="button">settings</button> <div class="reset svelte-esn2at"><button type="button">reset</button><!></div></div></div> <!></div></div>');function dn(e,t){G(t,!0);let a=T(t,"updated_url",31,()=>Xe(t.url)),s=T(t,"include_ancestors",3,!1),n=T(t,"include_replies",3,!1),o=T(t,"loading",15),l=T(t,"load_time",15),c=T(t,"initial_show_settings",3,!1),i=T(t,"show_settings",15),m=T(t,"autoload_storage_key",3,"autoload"),v=T(t,"initial_autoload",3,!1),y=T(t,"autoload",23,()=>m()?ne(m(),()=>v()):v()),h=Nt(1);const u=()=>{qe(h),a(t.url),o(void 0),l(void 0),t.onreset?.()},g=w(()=>t.settings_storage_key&&"show_settings"+t.settings_storage_key);Rt(()=>{i()===void 0&&i(r(g)?ne(r(g),()=>c()):c())}),Rt(()=>{r(g)&&se(r(g),i())}),Rt(()=>{m()&&se(m(),y())});const x=w(()=>ge(a())),d=w(()=>r(x)?.status_id??null),D=w(()=>r(x)?.host??null),A=w(()=>o()!==!1&&!!r(D)),E=w(()=>o()!==void 0||a()!==t.url);var R={reset:u},X=V(),C=B(X);return oa(C,()=>r(h),z=>{qa(z,{get host(){return r(D)},get id(){return r(d)},get include_ancestors(){return s()},get include_replies(){return n()},get cache(){return t.cache},get log(){return t.log},get reply_filter(){return t.reply_filter},get loading(){return o()},set loading(P){o(P)},get load_time(){return l()},set load_time(P){l(P)},children:(P,j)=>{let Z=()=>j?.().item,_t=()=>j?.().status_context,nt=()=>j?.().replies,st=()=>j?.().load,Ot=()=>j?.().loading,rt=()=>j?.().load_time;var ot=cn();let ct;var it=f(ot),gt=f(it);{var bt=I=>{var k=en();ve(k,21,()=>_t().ancestors,p=>p.id,(p,Q)=>{Yt(p,{get item(){return r(Q)}})}),_(k),W(3,k,()=>$),b(I,k)};O(gt,I=>{s()&&_t()&&I(bt)})}var vt=M(gt,2),ft=f(vt),Tt=f(ft);{var jt=I=>{var k=an(),p=f(k);ia(p,()=>({"--margin":"0"})),Yt(p.lastChild,{get item(){return Z()}}),_(p),_(k),W(3,k,()=>$),b(I,k)},At=I=>{var k=sn(),p=f(k);{let Q=w(()=>Ot()||!1),Ht=w(()=>!r(A));Da(p,{get pending(){return r(Q)},get disabled(){return r(Ht)},onclick:()=>st()(),children:(Dt,kt)=>{var dt=nn(),Mt=M(f(dt),2),mt=f(Mt),De=M(f(mt));{var ke=J=>{var ut=at("s");b(J,ut)};O(De,J=>{(n()||s())&&J(ke)})}Ut(),_(mt);var Kt=M(mt,2),Me=f(Kt);{var Ie=J=>{var ut=at();N(()=>tt(ut,r(D))),b(J,ut)},Ee=J=>{var ut=at("invalid url");b(J,ut)};O(Me,J=>{r(D)?J(Ie):J(Ee,!1)})}_(Kt),_(Mt),_(dt),b(Dt,dt)},$$slots:{default:!0}})}_(k),W(3,k,()=>$),b(I,k)};O(Tt,I=>{Z()?I(jt):I(At,!1)})}_(ft),_(vt);var H=M(vt,2);{var L=I=>{fe(I,{get item(){return Z()},get items(){return nt()}})};O(H,I=>{Z()&&nt()&&I(L)})}_(it);var q=M(it,2);{var Pt=I=>{var k=rn(),p=f(k);_(k),N(()=>Y(p,"href",Z().url)),W(3,k,()=>$),b(I,k)};O(q,I=>{Z()&&I(Pt)})}var yt=M(q,2),wt=f(yt),Jt=f(wt),xt=f(Jt);xt.__click=[tn,i];let Vt;ue(xt,"",{},{"margin-right":"var(--space_sm)"});var Gt=M(xt,2),pt=f(Gt);pt.__click=u;var be=M(pt);{var ye=I=>{var k=on(),p=f(k);_(k),N(Q=>tt(p,`loaded in ${Q??""}ms`),[()=>Math.round(rt())]),W(3,k,()=>$),b(I,k)};O(be,I=>{rt()!==void 0&&I(ye)})}_(Gt),_(Jt),_(wt),la(wt,(I,k)=>ka?.(I,k),()=>({onintersect:({intersecting:I})=>{I&&y()&&st()()},count:1}));var we=M(wt,2);{var xe=I=>{var k=ln(),p=f(k),Q=f(p),Ht=f(Q);$a(Ht,{get url(){return a()},set url(mt){a(mt)}}),_(Q);var Dt=M(Q,2),kt=f(Dt),dt=f(kt);_e(dt),Ut(),_(kt),_(Dt),_(p);var Mt=M(p,2);U(Mt,()=>t.settings??ce),_(k),N(()=>Y(kt,"title",y()?"replies will load automatically when scrolled intersect":"replies are not loaded until you request them")),Qe(dt,y),W(3,k,()=>$),b(I,k)};O(we,I=>{i()&&I(xe)})}_(yt),_(ot),N((I,k)=>{ct=zt(ot,1,"toot svelte-esn2at",null,ct,I),Vt=zt(xt,1,"deselectable",null,Vt,k),pt.disabled=!r(E)},[()=>({replies:nt()}),()=>({selected:i()})]),W(3,ot,()=>$),b(P,ot)},$$slots:{default:!0}})}),b(e,X),K(R)}le(["click"]);var un=S('<header><h1 class="mt_xl5 mb_lg"> </h1> <p class="mb_xl5"><!></p></header>');function _n(e,t){G(t,!0);var a=un(),s=f(a),n=f(s,!0);_(s);var o=M(s,2),l=f(o);ea(l,{get item(){return t.item}}),_(o),_(a),N(()=>tt(n,t.item.title)),b(e,a),K()}const vn=e=>{var t=fn();b(e,t)};var fn=S("<hr/>"),mn=S("<!>  <section><h2>Comments</h2> <!></section> <!>",1),hn=S("<article><!> <!> <!> <!></article>"),gn=S("<div>cannot find post <code> </code></div>"),bn=S('<div class="blog_post width_upto_md"><!></div>');function Hn(e,t){G(t,!0);const a=T(t,"separator",3,vn),n=ra.get().items.find(v=>v.slug===t.post.slug),o=ca.maybe_get();var l=bn();Je(v=>{N(()=>Ve.title=t.post.title)});var c=f(l);{var i=v=>{var y=hn();et(y,()=>({...t.attrs}));var h=f(y);_n(h,{get item(){return n}});var u=M(h,2);U(u,()=>t.children);var g=M(u,2);U(g,()=>t.footer??ce);var x=M(g,2);{var d=D=>{var A=mn(),E=B(A);U(E,a);var R=M(E,2),X=M(f(R),2);{var C=F=>{{let P=w(()=>o?.data);dn(F,{get url(){return n.comments.url},include_replies:!0,initial_autoload:!0,reply_filter:j=>({type:"favourited_by",favourited_by:[j.account.acct]}),get settings_storage_key(){return`${n.id??""}_comments_settings`},get cache(){return r(P)}})}};O(X,F=>{(!o||o.data!==void 0)&&F(C)})}_(R);var z=M(R,2);U(z,a),b(D,A)};O(x,D=>{n.comments&&D(d)})}_(y),b(v,y)},m=v=>{var y=gn(),h=M(f(y)),u=f(h,!0);_(h),_(y),N(()=>tt(u,t.post.slug)),b(v,y)};O(c,v=>{n?v(i):v(m,!1)})}_(l),b(e,l),K()}export{Hn as B};
